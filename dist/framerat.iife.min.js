/** MIT License
* 
* Copyright (c) 2011 Ludovic CLUBER
* 
* Permission is hereby granted, free of charge, to any person obtaining a copy
* of this software and associated documentation files (the "Software"), to deal
* in the Software without restriction, including without limitation the rights
* to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the Software is
* furnished to do so, subject to the following conditions:
* 
* The above copyright notice and this permission notice (including the next
* paragraph) shall be included in all copies or substantial portions of the
* Software.
* 
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
* SOFTWARE.
* 
* https://github.com/LCluber/FrameRat.js
*/

var FrameRat=function(t){"use strict";function n(t){return function(t,i){void 0===i&&(i=!0);var n=parseInt(t,10);return i?t===n:t==n}(t)||function(t,i){void 0===i&&(i=!0);var n=t%1!=0;return i?Number(t)===t&&n:Number(t)==t&&n}(t)}var c=function(){function t(){}return t.round=function(t,i){return i=Math.pow(10,i),Math.round(t*i)/i},t.floor=function(t,i){return i=Math.pow(10,i),Math.floor(t*i)/i},t.ceil=function(t,i){return i=Math.pow(10,i),Math.ceil(t*i)/i},t.trunc=function(t,i){var n=+t*(i=Math.pow(10,i));return isFinite(n)?(n-n%1)/i||(n<0?-0:0==n?n:0):n},t.roundToNearest=function(t,i){return Math.round(t/i)*i},t.mix=function(t,i,n){return(1-n)*t+n*i},t.getSign=function(t){return t?t<0?-1:1:0},t.opposite=function(t){return-t},t.clamp=function(t,i,n){return Math.min(Math.max(t,i),n)},t.normalize=function(t,i,n){return(t-i)/(n-i)},t.lerp=function(t,i,n){return(i-t)*n+t},t.map=function(t,i,n,r,e){return this.lerp(r,e,this.normalize(t,i,n))},t.isIn=function(t,i,n){return i<=t&&t<=n},t.isOut=function(t,i,n){return t<i||n<t},t}(),i=function(){function n(){}return n.init=function(){n.createRoundedPis(),n.createFactorialArray()},n.createRoundedPis=function(){this.pi=c.round(Math.PI,2),this.twopi=c.round(2*Math.PI,2),this.halfpi=c.round(.5*Math.PI,2)},n.createFactorialArray=function(){for(var t=3*this.sineLoops[this.sineLoops.length-1],i=2*this.cosineLoops[this.cosineLoops.length-1],n=1,r=1;n<=Math.max(t,i);n++)r*=this.factorial(n),this.factorialArray.push(r)},n.factorial=function(t){return 1<t?t-1:1},n.setSinePrecision=function(t){return 0<=t&&t<=this.maxDecimals?this.sineDecimals=t:this.sineDecimals=this.maxDecimals},n.setCosinePrecision=function(t){return 0<=t&&t<=this.maxDecimals?this.cosineDecimals=t:this.cosineDecimals=this.maxDecimals},n.setArctanPrecision=function(t){return 0<=t&&t<=this.maxDecimals?this.arctanDecimals=t:this.arctanDecimals=this.maxDecimals},n.degreeToRadian=function(t){return t*this.pi/180},n.radianToDegree=function(t){return 180*t/this.pi},n.normalizeRadian=function(t){return t>this.pi||t<-this.pi?t-this.twopi*Math.floor((t+this.pi)/this.twopi):t},n.sine=function(t){return t=this.normalizeRadian(t),n.sineDecimals<=2&&t<.28&&-.28<t?t:this.taylorSerie(3,n.sineLoops[this.sineDecimals],t,t,!0)},n.cosine=function(t){var i=(t=this.normalizeRadian(t))*t;return this.cosineDecimals<=2&&t<=.5&&-.5<=t?1-.5*i:this.taylorSerie(2,n.cosineLoops[this.cosineDecimals],1,t,!0)},n.arctan2=function(t,i){var n=i/t;return 0<t?this.arctan(n):t<0?i<0?this.arctan(n)-this.pi:this.arctan(n)+this.pi:i<0?-this.halfpi:0<i&&this.halfpi},n.arctan=function(t){var i=n.arctanLoops[this.arctanDecimals];return t<1&&-1<t?this.taylorSerie(3,i,t,t,!1):1<=t?(t=1/t,-(this.taylorSerie(3,i,t,t,!1)-this.halfpi)):(t=-1/t,this.taylorSerie(3,i,t,t,!1)-this.halfpi)},n.sineEquation=function(t,i,n,r){return t*this.sine(i+n)+r},n.cosineEquation=function(t,i,n,r){return t*this.cosine(i+n)+r},n.arctanEquation=function(t,i,n,r){return t*this.arctan(i+n)+r},n.taylorSerie=function(t,i,n,r,e){for(var s=r*r,a=n,o=-1;t<=i;t+=2,0)a+=(n*=s)/(e?this.factorialArray[t]:t)*o,o=c.opposite(o);return a},n}();i.sineLoops=[9,11,13,15,17,18,19,21,23],i.cosineLoops=[6,8,10,12,14,16,18,20,22],i.arctanLoops=[17,19,21,23,25,27,29,31,33],i.sineDecimals=2,i.cosineDecimals=2,i.arctanDecimals=2,i.maxDecimals=8,i.factorialArray=[],i.init();var r=function(){function t(){}return t.millisecToSec=function(t){return.001*t},t.secToMillisec=function(t){return 1e3*t},t.millisecToFps=function(t){return 1e3/t},t.fpsToMillisec=function(t){return 1e3/t},t}(),e=function(){function n(){}return n.min=function(t){return Math.min.apply(Math,t)},n.max=function(t){return Math.max.apply(Math,t)},n.sum=function(t){return t.reduce(function(t,i){return t+i},0)},n.multiply=function(t){return t.reduce(function(t,i){return t*i},0)},n.average=function(t,i){return n.sum(t)/i},n}(),s=function(){function t(){this.fpsArrayLength=60,this.fpsArray=Array(this.fpsArrayLength),this.reset()}var i=t.prototype;return i.reset=function(){this.now=0,this.total=0,this.delta=0,this.ticks=0,this.fpsArray.fill(60)},i.start=function(){this.now=performance.now()},i.tick=function(t){this.now=t,this.total+=this.delta,this.fpsArray[this.ticks%60]=r.millisecToFps(this.delta),this.ticks++},i.computeDelta=function(t){return this.delta=t-this.now},i.computeAverageFPS=function(){return e.average(this.fpsArray,this.fpsArrayLength)},t}(),a=function(){function t(t){this.frameId=0,this.minDelta=0,this.clock=new s,this.callback=t,this.running=!1}var i=t.prototype;return i.setMaxRefreshRate=function(t){this.minDelta=n(t)?r.fpsToMillisec(t):this.minDelta},i.getDelta=function(){return r.millisecToSec(this.clock.delta)},i.getTotal=function(){return r.millisecToSec(this.clock.total)},i.getFPS=function(){return this.clock.computeAverageFPS()},i.getTicks=function(){return this.clock.ticks},i.setScope=function(t){this.callback=this.callback.bind(t)},i.start=function(){return!this.running&&(this.startAnimation(),!0)},i.toggle=function(){return!!this.start()||(this.pause(),!1)},i.pause=function(){return!!this.running&&(this.stopAnimation(),!0)},i.stop=function(){this.clock.reset(),this.running&&this.stopAnimation()},i.tick=function(t){var i=!0,n=this.clock.computeDelta(t);(!this.minDelta||n>=this.minDelta)&&(this.clock.tick(t),!1===this.callback()&&(i=!1)),i?this.requestNewFrame():this.stop()},i.startAnimation=function(){this.clock.start(),this.running=!this.running,this.requestNewFrame()},i.stopAnimation=function(){this.running=!this.running,window.cancelAnimationFrame(this.frameId)},i.requestNewFrame=function(){this.frameId=window.requestAnimationFrame(this.tick.bind(this))},t}();return t.Player=a,t}({});