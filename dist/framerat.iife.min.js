/** MIT License
* 
* Copyright (c) 2011 Ludovic CLUBER
* 
* Permission is hereby granted, free of charge, to any person obtaining a copy
* of this software and associated documentation files (the "Software"), to deal
* in the Software without restriction, including without limitation the rights
* to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the Software is
* furnished to do so, subject to the following conditions:
* 
* The above copyright notice and this permission notice (including the next
* paragraph) shall be included in all copies or substantial portions of the
* Software.
* 
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
* SOFTWARE.
* 
* https://github.com/LCluber/FrameRat.js
*/

var FrameRat=function(t){"use strict";function i(t){return function(t,n){void 0===n&&(n=!0);var i=parseInt(t,10);return n?t===i:t==i}(t)||function(t,n){void 0===n&&(n=!0);var i=t%1!=0;return n?Number(t)===t&&i:Number(t)==t&&i}(t)}var c=function(){function t(){}return t.round=function(t,n){return n=Math.pow(10,n),Math.round(t*n)/n},t.floor=function(t,n){return n=Math.pow(10,n),Math.floor(t*n)/n},t.ceil=function(t,n){return n=Math.pow(10,n),Math.ceil(t*n)/n},t.trunc=function(t,n){var i=+t*(n=Math.pow(10,n));return isFinite(i)?(i-i%1)/n||(i<0?-0:0==i?i:0):i},t.roundToNearest=function(t,n){return Math.round(t/n)*n},t.mix=function(t,n,i){return(1-i)*t+i*n},t.sign=function(t){return t?t<0?-1:1:0},t.opposite=function(t){return-t},t.clamp=function(t,n,i){return Math.min(Math.max(t,n),i)},t.normalize=function(t,n,i){return(t-n)/(i-n)},t.lerp=function(t,n,i){return(i-n)*t+n},t.map=function(t,n,i,r,e){return this.lerp(this.normalize(t,n,i),r,e)},t.isEven=function(t){return!(1&t)},t.isOdd=function(t){return 1&t},t.isOrigin=function(t){return 0===t},t.isPositive=function(t){return 0<=t},t.isNegative=function(t){return t<0},t.contains=function(t,n,i){return n<=t&&t<=i},t}(),n=function(){function i(){}return i.init=function(){i.createRoundedPis(),i.createFactorialArray()},i.createRoundedPis=function(){this.pi=c.round(Math.PI,2),this.twopi=c.round(2*Math.PI,2),this.halfpi=c.round(.5*Math.PI,2)},i.createFactorialArray=function(){for(var t=3*this.sineLoops[this.sineLoops.length-1],n=2*this.cosineLoops[this.cosineLoops.length-1],i=1,r=1;i<=Math.max(t,n);i++)r*=this.factorial(i),this.factorialArray.push(r)},i.factorial=function(t){return 1<t?t-1:1},i.setSinePrecision=function(t){return t<this.sineLoops.length?this.sineDecimals=t:this.sineDecimals=2},i.setCosinePrecision=function(t){return t<i.cosineLoops.length?this.cosineDecimals=t:this.cosineDecimals=2},i.setArctanPrecision=function(t){return t<i.arctanLoops.length?this.cosineDecimals=t:this.arctanDecimals=2},i.degreeToRadian=function(t){return t*this.pi/180},i.radianToDegree=function(t){return 180*t/this.pi},i.normalizeRadian=function(t){return t>this.pi||t<-this.pi?t-this.twopi*Math.floor((t+this.pi)/this.twopi):t},i.sine=function(t){return t=this.normalizeRadian(t),i.sineDecimals<=2&&t<.28&&-.28<t?t:this.taylorSerie(3,i.sineLoops[this.sineDecimals],t,t,!0)},i.cosine=function(t){var n=(t=this.normalizeRadian(t))*t;return this.cosineDecimals<=2&&t<=.5&&-.5<=t?1-.5*n:this.taylorSerie(2,i.cosineLoops[this.cosineDecimals],1,t,!0)},i.arctan2=function(t,n){var i=n/t;return 0<t?this.arctan(i):t<0?n<0?this.arctan(i)-this.pi:this.arctan(i)+this.pi:n<0?-this.halfpi:0<n&&this.halfpi},i.arctan2Vector2=function(t){return this.arctan2(t.x,t.y)},i.arctan=function(t){var n=i.arctanLoops[this.arctanDecimals];return t<1&&-1<t?this.taylorSerie(3,n,t,t,!1):1<=t?(t=1/t,-(this.taylorSerie(3,n,t,t,!1)-this.halfpi)):(t=-1/t,this.taylorSerie(3,n,t,t,!1)-this.halfpi)},i.sineEquation=function(t,n,i,r){return t*this.sine(n+i)+r},i.cosineEquation=function(t,n,i,r){return t*this.cosine(n+i)+r},i.arctanEquation=function(t,n,i,r){return t*this.arctan(n+i)+r},i.taylorSerie=function(t,n,i,r,e){for(var o=r*r,s=i,a=-1;t<=n;t+=2,0)s+=(i*=o)/(e?this.factorialArray[t]:t)*a,a=c.opposite(a);return s},i}();n.sineLoops=[9,11,13,15,17,18,19,21,23],n.cosineLoops=[6,8,10,12,14,16,18,20,22],n.arctanLoops=[17,19,21,23,25,27,29,31,33],n.sineDecimals=2,n.cosineDecimals=2,n.arctanDecimals=2,n.factorialArray=[],n.init();var r=function(){function t(){}return t.millisecondToSecond=function(t){return.001*t},t.secondToMilliecond=function(t){return 1e3*t},t.millisecondToFramePerSecond=function(t){return 1e3/t},t.framePerSecondToMillisecond=function(t){return 1e3/t},t}(),e=function(){function i(){}return i.min=function(t){return Math.min.apply(Math,t)},i.max=function(t){return Math.max.apply(Math,t)},i.sum=function(t){return t.reduce(function(t,n){return t+n},0)},i.multiply=function(t){return t.reduce(function(t,n){return t*n},0)},i.average=function(t,n){return i.sum(t)/n},i}(),o=function(){function t(){this.fpsArrayLength=60,this.fpsArray=Array(this.fpsArrayLength),this.reset()}var n=t.prototype;return n.reset=function(){this.now=0,this.total=0,this.delta=0,this.ticks=0,this.fpsArray.fill(60)},n.start=function(){this.now=performance.now()},n.tick=function(t){this.now=t,this.total+=this.delta,this.fpsArray[this.ticks%60]=r.millisecondToFramePerSecond(this.delta),this.ticks++},n.computeDelta=function(t){return this.delta=t-this.now},n.computeAverageFPS=function(){return e.average(this.fpsArray,this.fpsArrayLength)},t}(),s=function(){function t(t){this.frameId=0,this.minDelta=0,this.clock=new o,this.callback=t,this.running=!1}var n=t.prototype;return n.setMaxRefreshRate=function(t){this.minDelta=i(t)?r.framePerSecondToMillisecond(t):this.minDelta},n.getDelta=function(){return r.millisecondToSecond(this.clock.delta)},n.getTotal=function(){return r.millisecondToSecond(this.clock.total)},n.getFPS=function(){return this.clock.computeAverageFPS()},n.getTicks=function(){return this.clock.ticks},n.setScope=function(t){this.callback=this.callback.bind(t)},n.start=function(){return!this.running&&(this.startAnimation(),!0)},n.toggle=function(){return!!this.start()||(this.pause(),!1)},n.pause=function(){return!!this.running&&(this.stopAnimation(),!0)},n.stop=function(){this.clock.reset(),this.running&&this.stopAnimation()},n.tick=function(t){var n=!0,i=this.clock.computeDelta(t);(!this.minDelta||i>=this.minDelta)&&(this.clock.tick(t),!1===this.callback()&&(n=!1)),n?this.requestNewFrame():this.stop()},n.startAnimation=function(){this.clock.start(),this.running=!this.running,this.requestNewFrame()},n.stopAnimation=function(){this.running=!this.running,window.cancelAnimationFrame(this.frameId)},n.requestNewFrame=function(){this.frameId=window.requestAnimationFrame(this.tick.bind(this))},t}();return t.Player=s,t}({});